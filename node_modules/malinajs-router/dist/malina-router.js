import{store as p}from"storxy";var i=w();function w(){let t=window.location.pathname==="srcdoc",a=()=>t?$():b(),o=(e,n)=>{t?window.location.hash=e:history.pushState({},"",e),n.$=a()},r=p(a(),()=>{window.hashchange=window.onpopstate=()=>{r.$=a()};let e=g(n=>o(n,r));return()=>{window.hashchange=window.onpopstate=null,e()}});return{subscribe:r.subscribe,$$:r.subscribe,goto:e=>o(e,r),method:e=>r.$=a(t=e==="hash")}}function b(){return{path:window.location.pathname,query:f(window.location.href),hash:window.location.hash.slice(1)}}function $(){let t=String(window.location.hash.slice(1)||"/").match(/^([^?#]+)(?:\?([^#]+))?(?:#(.+))?$/);return{path:t[1]||"",query:f(window.location.href),hash:t[3]||""}}function g(t){let a=o=>{let r=o.target.closest("a[href]");r&&/^\/$|^\/\w|^\/#\/\w/.test(r.getAttribute("href"))&&(o.preventDefault(),t(r.getAttribute("href").replace(/^\/#/,"")))};return addEventListener("click",a),()=>removeEventListener("click",a)}function f(t){let a=new URL(t).searchParams,o={};for(let[r,e]of a)o[`${r}`]=e;return o}import{store as k}from"storxy";import{$context as u,$onDestroy as x,$tick as m}from"malinajs/runtime.js";function v(t){let a=t.fallback?"fallbacks":"childs",o=k({}),r={url:"",query:"",params:{},subscribe:o.subscribe};o.$=r;let e={un:null,exact:!1,pattern:"",parent:u.parent,fallback:t.fallback,childs:new Set,activeChilds:new Set,fallbacks:new Set,active:!1,makePattern(n){e.exact=!n.endsWith("/*"),e.pattern=h(`${e.parent&&e.parent.pattern||""}${n}`)},register:()=>{if(!!e.parent)return e.parent[a].add(e),()=>{e.parent[a].delete(e),e.un&&e.un()}},show:()=>{e.redirect?i.goto(e.redirect):(t.onShow(),!e.fallback&&e.parent&&e.parent.activeChilds.add(e),e.active=!0)},hide:()=>{t.onHide(),!e.fallback&&e.parent&&e.parent.activeChilds.delete(e),e.active=!1},match:n=>{let s=d(e.pattern,n);!e.fallback&&s&&(!e.exact||e.exact&&s.exact)?(e.show(),r.params=s.params,o.$=r):e.hide(),m(()=>{if(s&&e.childs.size>0&&e.activeChilds.size==0){let c=e;for(;c.fallbacks.size==0;)if(c=c.parent,!c)return;c&&c.fallbacks.forEach(l=>{l.show()})}})},meta:r};return e.makePattern(t.path),e.un=i.subscribe(n=>{r.url=n.path,r.query=n.query,r.params={},o.$=r,e.match(n.path),t.force&&e.active&&(t.onHide(),m(()=>t.onShow()))}),u.parent=e,u.route=e.meta,x(e.register()),e}function d(t,a){t=h(t),a=h(a);let o=[],r={},e=!0,n=t.split("/").map(c=>c.startsWith(":")?(o.push(c.slice(1)),"([^\\/]+)"):c).join("\\/"),s=a.match(new RegExp(`^${n}$`));if(s||(e=!1,s=a.match(new RegExp(`^${n=="\\/"?"":n}/|^${n}$`))),!!s)return o.forEach((c,l)=>r[c]=s[l+1]),{exact:e,params:r}}function h(t){return t=t.replace(/(^\/#)|(^\/\/#)|(^\/\/)|(\/\*$)|(\/$)/g,""),t.startsWith("/")||(t="/"+t),t}export{v as createRouteObject,d as getParams,i as router};
