#!/usr/bin/env node
var x=Object.create;var m=Object.defineProperty;var g=Object.getOwnPropertyDescriptor;var b=Object.getOwnPropertyNames;var $=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty;var P=e=>m(e,"__esModule",{value:!0});var j=(e,s,o)=>{if(s&&typeof s=="object"||typeof s=="function")for(let t of b(s))!y.call(e,t)&&t!=="default"&&m(e,t,{get:()=>s[t],enumerable:!(o=g(s,t))||o.enumerable});return e},E=e=>j(P(m(e!=null?x($(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var w=E(require("../dist/derver.cjs.js"));var N="derver",S="Derver is a tiny development web server with livereload and files watching.",U="[params] [serve dir]",A=[{name:"host",help:"Host where to bind server"},{name:"port",help:"Port where to bind server"},{name:"index",help:"Index file for server"},{name:"watch",multiple:!0,help:"Directory for watching. May be used multiple times."},{name:"no-watch",help:"Prevent any watching."},{name:"compress",help:"Return files compressed by gzip or brotli, if client supports it."},{name:"cache",help:"Add Cache-control header."},{name:"spa",help:"Enaples SPA mode when all page requests will be responced by index page."},{name:"production",help:"Run server in production mode: enables --compress,--cache and--no-watch parameters"},{name:"help",help:"Show usage information"}],D=["","dist/public","--host=0.0.0.0 --port=5000","--watch=dist/public --watch=src","--production"],p={name:N,description:S,usage:U,params:A,examples:D};function d(){let e={dir:".",params:{}},s=process.argv.slice(2);if(s.length==0)return e;s[s.length-1].startsWith("-")||(e.dir=s.pop());for(let o of s){let t=o.split("="),n=t[0].replace(/^\-{1,2}/,""),c=t[1]||!0,l=n in e.params,h=p.params.find(v=>v.name==n);if(!h)return!1;if(h.multiple)l||(e.params[n]=[]),e.params[n].push(c);else{if(l)return!1;e.params[n]=c}}return e}function u(e=0){process.exit(e)}function f(){return`${p.description}

Usage:
    ${p.name} ${p.usage}

Parameters:
${p.params.map(e=>`  ${e.name.padEnd(15)} ${e.help}`).join(`
`)}

Examples:
${p.examples.map(e=>`  ${p.name} ${e}`).join(`
`)}
`}var r=d();(!r||r.params.help)&&(console.log(f()),u());var a={};r.dir&&(a.dir=r.dir);r.params.index&&(a.index=r.params.index);r.params.watch&&(a.index=r.params.watch);r.params["no-watch"]&&(a.watch=!1);r.params.spa&&(a.spa=!0);r.params.compress&&(a.compress=!0);r.params.cache&&(a.cache=r.params.cache===!0?!0:Number(r.params.cache));r.params.scroll&&(a.preserveScroll=r.params.scroll===!0?10:Number(r.params.scroll));r.params.production&&(a.compress=!0,a.cache=!0,a.watch=!1,a.host="0.0.0.0");r.params.host&&(a.host=r.params.host);r.params.port&&(a.port=Number(r.params.port));(0,w.derver)(a);
